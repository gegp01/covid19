<!doctype html>
<html>
<head>
	
	<title>modelo EpI-PUMA</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<!--link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" /-->
  
  <!--link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script-->

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css">
	<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>

	<style>
		body {
			padding: 0;
			margin: 0;
		}
		
		html, body, #map {
			height: 100%;
			width: 100%;
		}
		.leaflet-popup-content-wrapper{
			background-color: azure;
			opacity: 0.7;
		}
		
		.leaflet-popup-tip {
			background: royalblue;
		}
		
		
		/*Legend specific*/
		.legend {
		  padding: 6px 8px;
		  font: 14px Arial, Helvetica, sans-serif;
		  background: white;
		  background: rgba(255, 255, 255, 0.8);
		  box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
		  border-radius: 5px;
		  line-height: 24px;
		  color: #555;
		}
		.legend h5 {
		  text-align: center;
		  font-size: 13px;
		  margin: 2px 8px 8px;
		  color: #777;
		}

		.legend span {
		  position: relative;
		  bottom: 3px;
		}

		.legend i {
		  width: 18px;
		  height: 18px;
		  float: left;
		  margin: 0 8px 0 0;
		  opacity: 0.7;
		}

		.legend i.icon {
		  background-size: 18px;
		  background-color: rgba(255, 255, 255, 1);
		}

	</style>
</head>
	
<body>
	<div id='map'></div>
	<script src="epipuma.geojson"></script>
	<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
	
	<script type="text/javascript">
			
		
	function style_1(feature) {
		return {
			weight: 2,
			opacity: 1,
			color: 'transparent',
			dashArray: '3',
			fillOpacity: 0.5,
			fillColor: feature.properties.semaforo
		};
	}
		
	function style_infectados(feature) {
		return {
			weight: 2,
			opacity: 1,
			color: 'transparent',
			// dashArray: '3',
			fillOpacity: 0.5,
			fillColor: feature.properties.inf15d10mil_col
		};
	}	
	 
		
		
	function onEachFeature(feature, layer) {
			layer.bindPopup(
				"<div style='font-size:12px;'><b>modelo EpI-PUMA:</b></br><i>P(contagios | conectividad de personas)</i>" +
				"<br>Entrenamiento: 01 al 31 mayo 2020  <br>Validación: 01 al 30 junio 2020" + 
				"<hr><b>municipio: </b>" +
				feature.properties.MUNICIPIO +
				"<br><b>entidad federativa: </b>" +
				feature.properties.ENTIDAD +
				"<br><b>riesgo: </b>" +
				feature.properties.riesgo +		
				"<br><b>score: </b>" +
				Math.round(feature.properties.score) +
				"<br><b>positive score: </b>" +
				Math.round(feature.properties.positive_score) +	
				"<br><b>negative score: </b>" +
				Math.round(feature.properties.negative_score) +				
				"</div>" +
				'<hr><p align=right><img width=80vh alt="C3" src = "https://www.c3.unam.mx/image/logo.png" style="align-text:right; background-color: #3e484f;"/></p>'
			)
		}
			

	var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
	    '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
	    'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
		mbUrl = 'https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZ2VncCIsImEiOiJjamt1bjR6dDkwMDRvM3hvOHdwOGVlNmdqIn0.sCmUZr_hp4SZPKdcE88OYA';
	var grayscale   = L.tileLayer(mbUrl, {id: 'mapbox/light-v9', tileSize: 512, zoomOffset: -1, attribution: mbAttr}),
		streets  = L.tileLayer(mbUrl, {id: 'mapbox/streets-v11', tileSize: 512, zoomOffset: -1, attribution: mbAttr});

	var score;
	var score = new L.geoJson(modelo, {style:style_1, onEachFeature: onEachFeature});
		

	var baseLayers = {
		"mapa base": grayscale,
		"calles": streets
	};

	var overlays = {
		"categoría de riesgo para junio 2020" : score
	};

	var map = L.map('map', {
	center: [23.634501, -102.552784],
	zoom: 5,
	layers: [grayscale, score]
	});
		  
	L.control.layers(baseLayers, overlays).addTo(map);
	
	
	// Insertando una leyenda en el mapa
	var legend = L.control({position: 'topleft'});

		legend.onAdd = function(map) {
		  var div = L.DomUtil.create("div", "legend");
		  div.innerHTML += "<h5>Predicción: <br> contagios de COVID-19</h5>";
		  div.innerHTML += '<i style="background: #FF0000"></i><span>Muy Alto</span><br>';
		  div.innerHTML += '<i style="background: #FFA100"></i><span>Alto</span><br>';
		  div.innerHTML += '<i style="background: #FFFF00"></i><span>Mediano</span><br>';
		  div.innerHTML += '<i style="background: #AEFF00"></i><span>Bajo</span><br>';
		  div.innerHTML += '<i style="background: #00FF00"></i><span>Muy Bajo</span><br>';
//		  div.innerHTML += '<hr color= gray><p align=right><img width=80vh alt="C3" src = "https://www.c3.unam.mx/image/logo.png" style="align-text:right; background-color: #3e484f; margin-right:2px;"/></p>';
		return div;
		};
		
	legend.addTo(map);
	
			// Insertando una leyenda en el mapa
	var legend2 = L.control({position: 'bottomleft'});

		legend2.onAdd = function(map) {
		  var div = L.DomUtil.create("div", "legend2");
  		  div.innerHTML += '<img width=100vh alt="C3" src = "https://www.c3.unam.mx/image/logo.png" style="align-text:right; background-color: #3e484f;"/>';
		  //div.innerHTML += '<br><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet</a>';			
		  div.innerHTML +='<br><a class="resp-sharing-button__link" href="https://gegp01.github.io/covid19/epipuma.html" target="_blank" rel="noopener" aria-label=""><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--circle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.5 7.4l-2 .2c-.4-.5-1-.8-2-.8C13.3 6.8 12 8 12 9.4v.6c-2 0-4-1-5.4-2.7-.2.4-.3.8-.3 1.3 0 1 .4 1.7 1.2 2.2-.5 0-1 0-1.2-.3 0 1.3 1 2.3 2 2.6-.3.4-.7.4-1 0 .2 1.4 1.2 2 2.3 2-1 1-2.5 1.4-4 1 1.3 1 2.7 1.4 4.2 1.4 4.8 0 7.5-4 7.5-7.5v-.4c.5-.4.8-1.5 1.2-2z"/><circle cx="3" cy="2.5" r="2"/></svg></div></div></a>';

		return div;
		};
		
	legend2.addTo(map);

	
	</script>

</body>
</html>
